<!doctype html> <html> <head> <meta charset=UTF-8 /> <meta http-equiv=Content-Type content="text/html"/> <title>/code - AsktheRelic.com</title> <link rel=alternate type="application/rss+xml" title="RSS 2.0" href="/code/feed/"/> <link rel=stylesheet media=screen href="/stylesheets/code.css?1528814718"/> <link rel=stylesheet href='/stylesheets/github.css?1528814718'/> <link rel="shortcut icon" href="/favicon.ico?1528814718"> <script src="https://code.jquery.com/jquery-1.12.4.js" integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU=" crossorigin=anonymous></script> <script src="https://code.jquery.com/ui/1.8.24/jquery-ui.min.js" integrity="sha256-UOoxwEUqhp5BSFFwqzyo2Qp4JLmYYPTHB8l+1yhZij8=" crossorigin=anonymous></script> </head> <body> <div id=container> <div id=container2> <div id=container1> <div id=left> <div id=left-header> <h2><a href="/code">/code - a blog</a></h2> </div> <div id=content> <div id=main_block> <div id=prose_block class=post> <a name=itunes-perl-and-you /> <h2 class="blog.post_title"><a href="/2008/09/28/itunes-perl-and-you/">iTunes, Perl, and You</a></h2> <small>September 28, 2008 at 06:00 PM</small> <span class=post-prose> <p>I was updating my Facebook profile tonight and wanted to fill in the &ldquo;Favorite Music&rdquo; section with some real data from iTunes, considering I listen to 99% of my music through iTunes, my iPod, or iPhone, which means all of my stats get tracked through iTunes. Creating a Smart Playlist in iTunes of my most played music would be adequate, but I don&rsquo;t know of a way to that data out of iTunes without copying and pasting, a boring and time waste experience, so I turned to Perl.</p> <p>A friend of mine, <a href="http://dinomite.net/">Drew</a>, maintains a set of Perl scripts on CPAN to parse and help analyze your iTunes library XML file, aptly called <a href="http://search.cpan.org/~dinomite/">Mac-iTunes-Library</a> (you may have to search for it a bit).</p> <p>I installed the package via CPAN:</p> <pre class="highlight perl"><code><span class="nv">install</span> <span class="s">'Mac::iTunes::Library'</span>
</code></pre> <p>Then coded up up a script to pull the top 50 artists based on the number of tracks. Assuming I listen to these tracks, it&rsquo;s probably a good statistic that I like this artist.</p> <pre class="highlight perl"><code><span class="c1">#!/usr/bin/env perl</span>
<span class="k">use</span> <span class="nv">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nv">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">Mac::iTunes::</span><span class="nv">Library</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Mac::iTunes::Library::</span><span class="nv">XML</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

<span class="c1"># Make a new Library</span>
<span class="k">my</span> <span class="nv">$library</span> <span class="o">=</span> <span class="nn">Mac::iTunes::</span><span class="nv">Library</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">();</span>
<span class="nv">$library</span> <span class="o">=</span> <span class="nn">Mac::iTunes::Library::</span><span class="nv">XML</span><span class="o">-&gt;</span><span class="nv">parse</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>

<span class="c1">#hash of &lt;Artist, numTracks&gt;</span>
<span class="k">my</span> <span class="nv">%artists</span> <span class="o">=</span> <span class="nv">$library</span><span class="o">-&gt;</span><span class="nv">artist</span><span class="p">();</span>
<span class="k">my</span> <span class="nv">@sortedArtists</span> <span class="o">=</span> <span class="p">();</span>
<span class="k">my</span> <span class="nv">$count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">#sort function</span>
<span class="k">sub </span><span class="nf">numerically</span> <span class="p">{</span>
        <span class="nv">$artists</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span> <span class="sr">&lt;=&gt;</span> <span class="nv">$artists</span><span class="p">{</span><span class="nv">$a</span><span class="p">};</span>
<span class="p">}</span>

<span class="c1">#sort artists by the number of tracks, then grab the top 50</span>
<span class="k">for</span> <span class="k">my</span> <span class="nv">$artist</span> <span class="p">(</span><span class="nb">sort</span> <span class="nv">numerically</span> <span class="p">(</span><span class="nb">keys</span> <span class="nv">%artists</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="nv">$count</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">push</span><span class="p">(</span><span class="nv">@sortedArtists</span><span class="p">,</span> <span class="nv">$artist</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$count</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">#Now take the top 50 artists sorted by number of tracks,</span>
<span class="c1">#and sort alphabetically, and print</span>
<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$artist</span> <span class="p">(</span><span class="nb">sort</span><span class="p">(</span><span class="nv">@sortedArtists</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$artist, "</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">print</span> <span class="s">"n"</span><span class="p">;</span>
</code></pre> <p>Now, I&rsquo;m a beginner with Perl, but from a quick parse of the results, there are still some case-sensitivity issues that I&rsquo;m looking into; &ldquo;Boards of Canada&rdquo; and &ldquo;Boards Of Canada&rdquo; are seperate artists, but that&rsquo;s also a problem with iTunes not caring much about case either when saving data. With some minor formatting to the output, you should be rewarded with a list something like this:</p> <p><strong>311, Aphex Twin, Armin Van Buuren, BT, Bear McCreary, Beck, Cake, DJ Miko &amp; Mini Me, Daft Punk, Deep Forest, Depeche Mode, Dieselboy, Eels, Eminem, Foo Fighters, Frank Klepacki, Hybrid, Incubus, Infected Mushroom, Jack Johnson, Johnny Cash, Juno Reactor, Korn, Machinae Supremacy, Massive Attack, Metallica, Moby, Muse, Nine Inch Nails, Orbital, Pink Floyd, Placebo, Prodigy, Queen, Queens of the Stone Age, Radiohead, Rammstein, Scooter, Stabbing Westward, System of a Down, The Chemical Brothers, The Crystal Method, The Offspring, The Red Hot Chili Peppers, The Smashing Pumpkins, The Strokes, Tiesto, Weezer, Yo La Tengo, Yoko Kanno</strong></p> <p>Hurray data!</p> <p><strong>Update 05/17/2009</strong></p> <p>I tweaked the script to be compatible with version 0.5 of the library, some changes had been made since I last looked at this. You need to enter the library location as an argument now.</p> </span> </div> </div> <div class=hr></div> <div> <h4>Recent Articles</h4> <div class="post frontpage"> <span class=linkdate>08 Jan 2017 »</span> <a href="/2017/01/08/hosting-with-dokku/">Hosting with Dokku</a> </div> <div class="post frontpage"> <span class=linkdate>18 Sep 2016 »</span> <a href="/2016/09/18/testing-the-layers-of-your-application-at-pyconuk-2016/">Testing the Layers of Your Application at PyConUK 2016</a> </div> <div class="post frontpage"> <span class=linkdate>21 Apr 2014 »</span> <a href="/2014/04/21/upgrading-my-dotfiles-to-symlinks/">Upgrading My Dotfiles To Symlinks</a> </div> <div class="post frontpage"> <span class=linkdate>08 Feb 2014 »</span> <a href="/2014/02/08/another-year-another-set-of-backups/">Another Year, Another Set Of Backups</a> </div> <div class="post frontpage"> <span class=linkdate>02 Dec 2013 »</span> <a href="/2013/12/02/practical-lessons-learned-from-testing/">Practical Lessons Learned From Testing</a> </div> <div class="post frontpage"> <span class=linkdate>20 Nov 2013 »</span> <a href="/2013/11/20/streaming-small-http-responses-with-python/">Streaming Small HTTP Responses with Python</a> </div> <div class="post frontpage"> <span class=linkdate>03 Nov 2013 »</span> <a href="/2013/11/03/an-exploration-in-selecting-things/">An Exploration In Selecting Things</a> </div> </div> </div> <div class=hr></div> <p id=credits> Powered by <a href="http://middlemanapp.com/">Middleman</a>. <br/> <br/> </p> </div> <div id=right> <div id=right-header> <a href="/"><h1>Ask the Relic</h1></a> </div> </div> </div> </div> </div> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-1004202-1', 'auto');
  ga('send', 'pageview');
</script> </body> </html>